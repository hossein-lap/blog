<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Helper functions: Perl language | Hos Notes</title>
    <link rel="stylesheet" href="../../../../_/css/site.css">
    <link rel="stylesheet" href="../../../../_/css/vendor/tabs.css">
    <meta name="generator" content="Antora 3.1.14">
    <link rel="canonical" href="https://hossein-lap.github.io/programming-perl/0.1.0/perl/helpers/index.html">
    <meta property="og:url" content="https://hossein-lap.github.io/programming-perl/0.1.0/perl/helpers/index.html">
    <meta property="og:description" content="A documentation page for Perl Programming Language.">
    <meta property="og:site_name" content="Asciidoctor Docs">
    <meta name="twitter:card" content="summary_large_image">
    <meta property="og:title" content="Perl Programming Language - Helper functions: Perl language">
    <meta property="og:image" content="https://hossein-lap.github.io/_/img/asciidoctor-og.png">
    <meta name="twitter:site" content="@asciidoctor">
    <meta name="page-spec" content="programming-perl::perl/helpers/index.adoc">
    <link rel="icon" href="../../../../_/img/favicon.ico" type="image/x-icon">
  </head>
  <body class="article">
<header class="header">
  <nav class="navbar">
    <div class="navbar-brand">
    <!-- Put the logo here -->
    <a class="navbar-item logo" title="Hos Notes" href="https://hossein-lap.github.io/note-base/0.1.0/index.html">
        <img src="../../../../_/img/logo.jpg" alt="Hos Notes" width="48">
      </a>
      <a class="navbar-item title" href="https://hossein-lap.github.io/note-base/0.1.0/index.html">Hos Notes</a>
      <button class="navbar-burger" aria-controls="topbar-nav" aria-expanded="false" aria-label="Toggle main menu">
        <span></span>
        <span></span>
        <span></span>
      </button>
    </div>

    <div id="topbar-nav" class="navbar-menu">
      <div class="navbar-end">
        <div class="navbar-item has-dropdown is-hoverable">
          <div class="navbar-link">Languages</div>
          <div class="navbar-dropdown">
            <div class="navbar-item">Programming</div>
              <a class="navbar-item" href="../../../../programming-go/0.1.0/index.html">
                Go <small>Tooling</small>
              </a>
              <a class="navbar-item" href="#">
                Lua <small>Plugable</small>
              </a>
              <a class="navbar-item" href="../../index.html">
                Perl <small>Scripting</small>
              </a>
            <hr class="navbar-divider">
            <div class="navbar-item">Markup</div>
              <a class="navbar-item" href="#">
                Asciidoc <small></small>
              </a>
          </div>
        </div>
        <div class="navbar-item has-dropdown is-hoverable">
          <div class="navbar-link">Tools</div>
          <div class="navbar-dropdown">
            <div class="navbar-item">CLI Tooling</div>
              <a class="navbar-item" href="../../../../tool-git/0.1.0/index.html">
                Git <small>Version Control</small>
              </a>
            <hr class="navbar-divider">
          </div>
        </div>

        <!-- <div class="navbar-item has-dropdown is-hoverable"> -->
        <!--   <div class="navbar-link">section</div> -->
        <!--   <div class="navbar-dropdown"> -->
        <!--     <div class="navbar-item">subsection</div> -->
        <!--       <a class="navbar-item" href="../../../../tool-git/0.1.0/index.html"> -->
        <!--         itemize <small>item</small> -->
        <!--       </a> -->
        <!--     <hr class="navbar-divider"> -->
        <!--   </div> -->
        <!-- </div> -->

        <div class="navbar-item has-dropdown is-hoverable">
          <div class="navbar-link">Info</div>
          <div class="navbar-dropdown is-right">
            <div class="navbar-item">Contact</div>
              <a class="navbar-item" href="mailto:hosteam01@gmail.com">
                E-mail <small>hosteam01@gmail.com</small>
              </a>
            <hr class="navbar-divider">
            <div class="navbar-item">Social</div>
              <a class="navbar-item" href="https://github.com/hossein-lap">
                Github <small>hossein-lap</small>
              </a>
              <a class="navbar-item" href="https://gitlab.com/primejade">
                Gitlab <small>primejade</small>
              </a>
              <a class="navbar-item" href="https://linkedin.com/in/hossein-esmail">
                Linked-in <small>hossein-esmail</small>
              </a>
          </div>
        </div>

        <!-- <div class="navbar-item has-dropdown is-hoverable"> -->
        <!--   <a class="navbar-item" href="#" data-title="Support"> -->
        <!--     <span class="icon"><img src="../../../../_/img/octicons-24.svg#view-comment-discussion"></span> -->
        <!--   </a> -->
        <!--   <div class="navbar-dropdown is-right"> -->
            <!-- <a class="navbar-item has-icon" href="https://chat.asciidoctor.org" target="_blank" rel="noopener"> -->
            <!--   <span class="icon"><img src="../../../../_/img/octicons-16.svg#view-comment-discussion"></span> -->
            <!--   <span>Chat</span> -->
            <!-- </a> -->
            <!-- <a class="navbar-item has-icon" href="mailto://hosteam01@gmail.com" target="_blank" rel="noopener"> -->
            <!--   <span class="icon"><img src="../../../../_/img/octicons-16.svg#view-linked-in"></span> -->
            <!--   <span>E-Mail</span> -->
            <!-- </a> -->
        <!--     <a class="navbar-item has-icon" href="mailto://hosteam01@gmail.com" target="_blank" rel="noopener"> -->
        <!--       <span class="icon"><img src="../../../../_/img/octicons-16.svg#view-mail"></span> -->
        <!--       <span>E-Mail</span> -->
        <!--     </a> -->
        <!--     <a class="navbar-item has-icon" href="https://github.com/hossein-lap" target="_blank" rel="noopener"> -->
        <!--       <span class="icon"><img src="../../../../_/img/octicons-16.svg#view-mark-github"></span> -->
        <!--       <span>Github</span> -->
        <!--     </a> -->
        <!--     <a class="navbar-item has-icon" href="https://github.com/hossein-lap" target="_blank" rel="noopener"> -->
        <!--       <span class="icon"><img src="../../../../_/img/octicons-16.svg#view-mark-gitlab"></span> -->
        <!--       <span>Gitlap</span> -->
        <!--     </a> -->
            <!-- <a class="navbar-item has-icon" href="https://twitter.com/asciidoctor" target="_blank" rel="noopener"> -->
            <!--   <span class="icon"><img src="../../../../_/img/octicons-16.svg#view-hash"></span> -->
            <!--   <span>Tweets</span> -->
            <!-- </a> -->
        <!--   </div> -->
        <!-- </div> -->

      </div>
    </div>

  </nav>
</header>
<div class="body">
<div class="nav-container">
  <aside class="nav">
    <div class="panels">
<div class="nav-panel-menu is-active is-loading" data-panel="menu">
  <nav class="nav-menu">
    <button class="nav-menu-toggle" aria-label="Toggle expand/collapse all" style="display: none"></button>
    <h3 class="title"><a href="../../index.html">Perl Programming Language</a></h3>
<ul class="nav-list">
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../syntax/index.html">Basic Syntax</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../syntax/syntax-00-introduction.html">Syntax :: Introduction</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../syntax/syntax-01-variables.html">Syntax :: Variables</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../syntax/syntax-02-numbers.html">Syntax :: Numbers</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../syntax/syntax-03-strings.html">Syntax :: Strings</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../syntax/syntax-04-operators.html">Syntax :: Operators</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../syntax/syntax-05-list.html">Syntax :: list</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../syntax/syntax-06-array.html">Syntax :: array</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../syntax/syntax-07-hash.html">Syntax :: hash</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../syntax/syntax-08-if.html">Syntax :: if</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../syntax/syntax-09-unless.html">Syntax :: unless</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../syntax/syntax-10-given.html">Syntax :: given</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../syntax/syntax-11-for.html">Syntax :: for</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../syntax/syntax-12-while.html">Syntax :: while</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../syntax/syntax-13-do-while.html">Syntax :: do-while</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../syntax/syntax-14-until.html">Syntax :: until</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../syntax/syntax-15-next.html">Syntax :: next</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../syntax/syntax-16-last.html">Syntax :: last</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../syntax/syntax-17-reference.html">Syntax :: Reference</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../syntax/syntax-18-subroutine.html">Syntax :: Subroutine</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../syntax/syntax-19-module.html">Syntax :: Module</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../syntax/syntax-20-oop.html">Syntax :: OOP</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../syntax/syntax-21-dbi.html">Syntax :: DBI</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../syntax/syntax-22-sort.html">Syntax :: sort</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../syntax/syntax-23-open-file.html">Syntax :: Open File</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../syntax/syntax-24-read-file.html">Syntax :: Read File</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../syntax/syntax-25-write-file.html">Syntax :: Write to File</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../syntax/syntax-26-file-test-ops.html">Syntax :: File Test Operations</a>
  </li>
</ul>
  </li>
  <li class="nav-item is-current-url" data-depth="1">
    <a class="nav-link" href="index.html">Helpers</a>
  </li>
</ul>
  </li>
</ul>
  </nav>
  <script>
;(function () {
  var panel = document.querySelector('.nav-panel-menu')
  var page
  var hash = window.location.hash
  if (hash) {
    if (~hash.indexOf('%')) hash = decodeURIComponent(hash)
    if (~hash.indexOf('"')) hash = hash.replace(/(?=")/g, '\\')
    var link = panel.querySelector('.nav-link[href="' + hash + '"]')
    if (link) page = link.parentNode
    else if ((page = panel.querySelector('.is-current-url'))) page.classList.add('is-provisional')
  } else {
    page = panel.querySelector('.is-current-url')
  }
  if (page) {
    var ancestor = page
    while ((ancestor = ancestor.parentNode) && ancestor !== panel) {
      if (ancestor.className === 'nav-item') ancestor.classList.add('is-current-path', 'is-active')
    }
    page.classList.add('is-current-page', 'is-active')
    if (panel.scrollHeight > panel.clientHeight) {
      var panelRect = panel.getBoundingClientRect()
      var linkRect = page.querySelector('.nav-link').getBoundingClientRect()
      panel.scrollTop += Math.round(linkRect.top - panelRect.top - (panelRect.height - linkRect.height) * 0.5)
    }
  } else {
    panel.scrollTop = 0
  }
  panel.classList.remove('is-loading')
})()
  </script>
</div>
<div class="nav-panel-explore" data-panel="explore">
  <div class="context">
    <span class="title">Perl Programming Language</span>
    <span class="version">0.1.0</span>
  </div>
  <ul class="components">
    <li class="component">
      <a class="title" href="../../../../note-base/0.1.0/index.html">Blog</a>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../../../note-base/0.1.0/index.html">0.1.0</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../../../../tool-git/0.1.0/index.html">Git Version Control System</a>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../../../tool-git/0.1.0/index.html">0.1.0</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../../../../programming-go/0.1.0/index.html">Go Programming Language</a>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../../../programming-go/0.1.0/index.html">0.1.0</a>
        </li>
      </ul>
    </li>
    <li class="component is-current">
      <a class="title" href="../../index.html">Perl Programming Language</a>
      <ul class="versions">
        <li class="version is-current is-latest">
          <a href="../../index.html">0.1.0</a>
        </li>
      </ul>
    </li>
  </ul>
</div>
    </div>
  </aside>
</div>
<main class="article">
<div class="toolbar" role="navigation">
<button class="nav-toggle"></button>
  <a href="../../../../note-base/0.1.0/index.html" class="home-link" title="Home"></a>
<nav class="breadcrumbs" aria-label="breadcrumbs">
  <ul>
    <li><a href="../../index.html">Perl Programming Language</a></li>
    <li><a href="index.html">Helpers</a></li>
  </ul>
</nav>
<div class="edit-this-page"><a href="https://github.com/hossein-lap/note-perl/edit/devel/docs/modules/ROOT/pages/perl/helpers/index.adoc">Edit this Page</a></div>
</div>
  <div class="content">
<aside class="toc sidebar" data-title="Contents" data-levels="2">
  <div class="toc-menu"></div>
</aside>
<article class="doc programming-perl">
<h1 class="page">Helper functions: Perl language</h1>
<div id="preamble">
<div class="sectionbody">
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<div class="title">Background</div>
<p>I prefer to use <strong>only</strong> Perl&#8217;s core modules (or those of any other language I&#8217;m
using) for portability. Thus I&#8217;m always writing some of the functionalities
that I need and use.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<div class="title">Version</div>
<p>I tested and used these code against this version of Perl:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">perl --version</code></pre>
</div>
</div>
<div class="literalblock">
<div class="title">Output</div>
<div class="content">
<pre>This is perl 5, version 38, subversion 2 (v5.38.2) built for
x86_64-linux-gnu-thread-multi (with 51 registered patches, see perl -V for more
detail)

Copyright 1987-2023, Larry Wall

Perl may be copied only under the terms of either the Artistic License or the
GNU General Public License, which may be found in the Perl 5 source kit.

Complete documentation for Perl, including FAQ lists, should be found on
this system using "man perl" or "perldoc perl".  If you have access to the
Internet, point your browser at https://www.perl.org/, the Perl Home Page.</pre>
</div>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>And there we go.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_logging"><a class="anchor" href="#_logging"></a>1. Logging</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Better terminal output.</p>
</div>
<div class="listingblock">
<div class="title">Modules</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-perl hljs" data-lang="perl">use warnings;
use strict;
use POSIX qw(strftime);  # current time</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Subroutine</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-perl hljs" data-lang="perl">sub logger {
    my $subname = (caller(0))[3];
    my ($package, $filename, $line) = caller();
    my ($msg, $level, $modname) = @_;
    my $message;
    $modname = $subname unless $modname;
    my $current_date = strftime("%Y-%m-%d %H:%M:%S", localtime);
    $message = "] $current_date ${filename} ${modname} ${line} | $msg";
    if ($level eq 1) {
        print("$message\n");
    } elsif ($level eq 2) {
        print(STDERR "$message\n");
    } elsif ($level eq 3) {
        print(STDERR "$message\n");
        exit $line;
    }
}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">How to use it</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-perl hljs" data-lang="perl">unless (-d $path) {
    logger("$path: No such file or directory", 3, $subname);
}</code></pre>
</div>
</div>
<div class="literalblock">
<div class="title">Output</div>
<div class="content">
<pre>] 2025-09-04 15:36:07 navigator main::finder 46 | /dev/null: No such file or directory</pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_finding_files"><a class="anchor" href="#_finding_files"></a>2. Finding files</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Find files or directories basted on path, type and name pattern</p>
</div>
<div class="listingblock">
<div class="title">Modules</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-perl hljs" data-lang="perl">use Cwd 'abs_path';  # get absolute path</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Subroutine</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-perl hljs" data-lang="perl">sub finder {
    my $subname = (caller(0))[3];
    my ($opts) = @_; # hashref
    $opts ||= {};
    my $path     = $opts-&gt;{path}    // '.';
    my $type     = $opts-&gt;{type}    // '';
    my $pattern  = $opts-&gt;{pattern} // '';
    my $hidden   = $opts-&gt;{hidden}  // 0;
    unless (-d $path) {
        logger("$path: No such file or directory", 3, $subname);
    }
    $path =~ s,/$,,;  # remove trailing /
    my @directories;
    opendir (my $dir, $path);
    while (my $entry = readdir $dir) {
        my $full_path;
        if ($path =~ /^\//) {  # double check for full name vs relative name
            $full_path = $path."/".$entry;
        } else {
            $full_path = abs_path($entry);
        }
        unless ($hidden) {
            next if $entry =~ /^\./;  # show hidden files or don't
        }
        next if $entry eq '.' or $entry eq '..';  # ignore . and .. directory
        if ($type eq "d") {
            next unless -d $full_path;
        } elsif ($type eq "f") {
            next unless -f $full_path;
        } elsif ($type eq "l") {
            next unless -l $full_path;
        } else {
            next unless -e $full_path;
        }
        if ($pattern) {
            if ($entry =~ /$pattern/) {
                push(@directories, $full_path);
            }
        } else {
            push(@directories, $full_path);
        }
    }
    return sort @directories;
    closedir $dir;
}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">How to use it</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-perl hljs" data-lang="perl">my @root = finder({path =&gt; "/tmp", type =&gt; "d", pattern =&gt; "systemd"});
foreach my $dir (@root) {
    print("$dir\n");
}</code></pre>
</div>
</div>
<div class="literalblock">
<div class="title">Output</div>
<div class="content">
<pre>/tmp/systemd-private-8d727da391f74241890c032844d152d1-ModemManager.service-NByLAH
/tmp/systemd-private-8d727da391f74241890c032844d152d1-fwupd.service-A4BZql
/tmp/systemd-private-8d727da391f74241890c032844d152d1-polkit.service-lYqcFr
/tmp/systemd-private-8d727da391f74241890c032844d152d1-power-profiles-daemon.service-Fx9E2m
/tmp/systemd-private-8d727da391f74241890c032844d152d1-switcheroo-control.service-J56YmG
/tmp/systemd-private-8d727da391f74241890c032844d152d1-systemd-logind.service-qi68SJ
/tmp/systemd-private-8d727da391f74241890c032844d152d1-systemd-resolved.service-bN81cy
/tmp/systemd-private-8d727da391f74241890c032844d152d1-systemd-timesyncd.service-T6AXjP
/tmp/systemd-private-8d727da391f74241890c032844d152d1-upower.service-nTuKst</pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_fetch_download_file"><a class="anchor" href="#_fetch_download_file"></a>3. Fetch / Download file</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Yeah, I don&#8217;t know why, But I wrote it anyway :)</p>
</div>
<div class="listingblock">
<div class="title">Modules</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-perl hljs" data-lang="perl">use File::Path qw(make_path);  # directory handler
use File::Fetch;  # remote handler
use File::Basename;  # filename handling</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Subroutine</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-perl hljs" data-lang="perl">sub fetcher {
    my $subname = (caller(0))[3];
    my ($opts) = @_;  # hashref
    $opts ||= {};
    my $url        = $opts-&gt;{url}       // '';
    my $name       = $opts-&gt;{name}      // '';
    my $directory  = $opts-&gt;{directory} // $ENV{PWD};  # fallback to PWD
    make_path($directory) unless -d $directory;  # create output directory
    my $ff = File::Fetch-&gt;new(uri =&gt; $url);
    my $file = basename($url);
    my $full_name = $directory.'/'.$ff-&gt;file;
    my $return_value = {
        name =&gt; $name,
        url =&gt; $url,
        file =&gt; $ff-&gt;file,
        full_name =&gt; $full_name,
    };
    if (-f $full_name) {
        print(STDERR "[ignore] file already exists ");
        return $return_value;
    }
    # fetch
    my $where = $ff-&gt;fetch(to =&gt; "$directory/$name") or logger($ff-&gt;error, 3);
    return $return_value;
}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">How to use it</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-perl hljs" data-lang="perl">fetcher({
    url =&gt; "https://musl.libc.org/releases/musl-1.2.5.tar.gz",
    name =&gt; "musl.tar.gz",
    directory =&gt; "/tmp/fetch"
});</code></pre>
</div>
</div>
<div class="paragraph">
<div class="title">Output</div>
<p>This one is silent</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">ls -lhtr /tmp/fetch</code></pre>
</div>
</div>
<div class="literalblock">
<div class="content">
<pre>total 4.0K
drwxrwxr-x 2 hos hos 4.0K Sep  4 16:12 musl.tar.gz</pre>
</div>
</div>
<div class="paragraph">
<p>It will complain on error only:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-perl hljs" data-lang="perl">fetcher({
    url =&gt; "https://musl.libc.org/releases=musl-1.2.5.tar.gz",  # invalid URL
    name =&gt; "musl.tar.gz",
    directory =&gt; "/tmp/fetch"
});</code></pre>
</div>
</div>
<div class="literalblock">
<div class="content">
<pre>Fetch failed! HTTP response: 404 Not Found [404 Not Found] at tmp.pl line 54.
Command failed:  at tmp.pl line 54.
Command failed:  at tmp.pl line 54.
] 2025-09-04 16:15:46 tmp.pl main::logger 54 | Command failed:</pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_look_for_a_binary_in_the_path"><a class="anchor" href="#_look_for_a_binary_in_the_path"></a>4. Look for a binary in the PATH</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Kinda like bash&#8217;s <code>command</code> command =)</p>
</div>
<div class="paragraph">
<div class="title">Modules</div>
<p>Uses nothing special</p>
</div>
<div class="listingblock">
<div class="title">Subroutine</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-perl hljs" data-lang="perl">sub command {
    my $program = $_[0];
    my $path = $ENV{"PATH"};
    my @directories = split(":", $path);
    my $found = '';
    foreach my $dir (@directories) {
        my $full_path = "$dir/$program";
        if (-x $full_path) {
            $found = $full_path;
            last;
        }
    }
    return $found;
}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">How to use it</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-perl hljs" data-lang="perl">if (command("magick")) {
    $found_im = 0;
    $runner = command("magick");
} else {
    $found_im = 1;
}</code></pre>
</div>
</div>
<div class="paragraph">
<div class="title">Output</div>
<p>Does not print anything by itself</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_shell_commands"><a class="anchor" href="#_shell_commands"></a>5. Shell commands</h2>
<div class="sectionbody">
<div class="paragraph">
<p>A better way to execute shell command and capture the Exit code and create an
array of their output. This way we can iterate over the output line by line.</p>
</div>
<div class="paragraph">
<div class="title">Modules</div>
<p>Nothing extra; just the <code>warnings</code> and <code>strict</code>.</p>
</div>
<div class="listingblock">
<div class="title">Subroutine</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-perl hljs" data-lang="perl">sub commander {
    my $subname = (caller(0))[3];
    my ($package, $filename, $line) = caller();
    my @commands = @_;
    my $msg = "] $subname $line @commands";
    my $_command = "@commands";
    my $_cmd_output = `$_command`;
    my $err_msg = $!;
    my $cmd_exit_code = $? &gt;&gt; 8;
    chomp($_cmd_output);
    my @cmd_output = split("\n", $_cmd_output);
    print(STDERR "$msg: error") if $cmd_exit_code;
    if ($err_msg) {
        print(": $err_msg\n");
    } else {
        print("\n");
    }
    return (\@cmd_output, $cmd_exit_code);
}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">How to use it</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-perl hljs" data-lang="perl">my ($ref_cmd_output, $exit_code) = commander("ls -l /tmp");
exit 1 if $cmd_exit_code;  # exit on error
my @cmd_output = @{$ref_cmd_output};
foreach my $line (@cmd_output) {
    print("$line\n");  # do whatever you want with it
}</code></pre>
</div>
</div>
<div class="literalblock">
<div class="title">Output</div>
<div class="content">
<pre>total 76
drwx------ 2 hos  hos  4096 Sep  3 08:17 babel-O0fn1v
drwxrwxr-x 2 hos  hos  4096 Sep  3 08:17 babel-stable-556
drwxrwxr-x 3 hos  hos  4096 Sep  4 16:10 dl
drwxrwxr-x 3 hos  hos  4096 Sep  4 16:12 fetch
drwxr-xr-x 2 hos  hos  4096 Sep  4 16:23 hsperfdata_hos
drwxr-xr-x 2 root root 4096 Sep  3 11:57 hsperfdata_root
drwx------ 2 hos  hos  4096 Sep  3 08:17 net-export
drwx------ 4 hos  hos  4096 Sep  4 16:13 nvim.hos
-rw------- 1 hos  hos   168 Sep  3 08:17 serverauth.JAVaP1nh0z
drwx------ 3 root root 4096 Sep  2 17:57 systemd-private-8d727da391f74241890c032844d152d1-fwupd.service-A4BZql
drwx------ 3 root root 4096 Sep  2 17:03 systemd-private-8d727da391f74241890c032844d152d1-ModemManager.service-NByLAH
drwx------ 3 root root 4096 Sep  2 17:03 systemd-private-8d727da391f74241890c032844d152d1-polkit.service-lYqcFr
drwx------ 3 root root 4096 Sep  2 17:03 systemd-private-8d727da391f74241890c032844d152d1-power-profiles-daemon.service-Fx9E2m
drwx------ 3 root root 4096 Sep  2 17:03 systemd-private-8d727da391f74241890c032844d152d1-switcheroo-control.service-J56YmG
drwx------ 3 root root 4096 Sep  2 17:03 systemd-private-8d727da391f74241890c032844d152d1-systemd-logind.service-qi68SJ
drwx------ 3 root root 4096 Sep  2 17:03 systemd-private-8d727da391f74241890c032844d152d1-systemd-resolved.service-bN81cy
drwx------ 3 root root 4096 Sep  2 17:03 systemd-private-8d727da391f74241890c032844d152d1-systemd-timesyncd.service-T6AXjP
drwx------ 3 root root 4096 Sep  2 17:57 systemd-private-8d727da391f74241890c032844d152d1-upower.service-nTuKst
drwx------ 2 hos  hos  4096 Sep  2 18:01 tmux-1000</pre>
</div>
</div>
</div>
</div>
</article>
  </div>
</main>
</div>
<footer class="footer">
  <div class="footer-main">
    <figure class="footer-brand">
      <a class="logo" href="https://asciidoctor.org" target="_blank" rel="noopener"><img src="../../../../_/img/asciidoctor-logo.svg" alt="Asciidoctor" width="48"></a>
      <figcaption class="footer-brand-name"><a href="https://asciidoctor.org" target="_blank" rel="noopener">Asciidoctor</a></figcaption>
    </figure>
    <ul class="footer-brand-links">
      <!--
      <li><a href="https://asciidoctor.org" target="_blank" rel="noopener">Home</a></li>
      -->
      <li><a href="https://hossein-lap.github.io">Docs</a></li>
      <li><a href="https://chat.asciidoctor.org" target="_blank" rel="noopener">Chat</a></li>
      <li><a href="https://github.com/asciidoctor" target="_blank" rel="noopener">Source</a></li>
      <li><a href="https://discuss.asciidoctor.org" target="_blank" rel="noopener">List (archive)</a></li>
    </ul>
    <p class="footer-brand-follow">
      <a href="https://twitter.com/asciidoctor" title="Follow us on Twitter" target="_blank" rel="noopener"><img src="../../../../_/img/twitter-logo.svg" alt="Twitter logo" class="logo" width="28"><span class="handle">@asciidoctor</span></a>
    </p>
  </div>
  <div class="footer-legal">
    <p>Copyright © 2025 Dan Allen, Sarah White, and individual Asciidoctor contributors. Except where noted, the content is licensed under a Creative Commons Attribution 4.0 International (CC BY 4.0) license.</p>
    <!-- <p>The <a href="https://github.com/asciidoctor/asciidoctor-docs-ui" target="_blank" rel="noopener">UI for this site</a> is derived from the Antora default UI and is licensed under the MPL-2.0 license. Several icons are imported from <a href="https://primer.style/octicons/" target="_blank" rel="noopener">Octicons</a> and are licensed under the MIT license.</p> -->
    <p>AsciiDoc® and AsciiDoc Language™ are trademarks of the Eclipse Foundation, Inc.</p>
  </div>
  <div class="footer-thanks">
    <p>Thanks to our <a href="https://asciidoctor.org/supporters/" target="_blank" rel="noopener">backers</a> and <a href="https://asciidoctor.org/contributors/" target="_blank" rel="noopener">contributors</a> for helping to make this project possible. Additional thanks to:</p>
    <p class="badges">
      <a href="https://opendevise.com" title="Development support by OpenDevise" target="_blank" rel="noopener"><img src="https://secure.gravatar.com/avatar/823717a797dbd78ceff7b26aa397f383.png?size=80" alt="OpenDevise Logo" width="30"></a>
      <a href="https://zulip.com" title="Chat powered by Zulip" target="_blank" rel="noopener"><img src="../../../../_/img/zulip-logo.svg" alt="Zulip logo" width="30"></a>
      <a href="https://algolia.com/docsearch" title="Search by Algolia DocSearch" target="_blank" rel="noopener"><img src="../../../../_/img/algolia-logo.svg" alt="Algolia logo" width="30"></a>
      <a href="https://netlify.com" title="Deploys by Netlify" target="_blank" rel="noopener"><img src="../../../../_/img/netlify-logo.svg" alt="Deploys by Netlify" width="67"></a>
    </p>
    <p>Authored in <a href="https://asciidoc.org" target="_blank" rel="noopener">AsciiDoc</a>.<br>Produced by <a href="https://antora.org" target="_blank" rel="noopener">Antora</a> and <a href="https://asciidoctor.org" target="_blank" rel="noopener">Asciidoctor</a>.</p>
  </div>
</footer>
<script id="site-script" src="../../../../_/js/site.js" data-ui-root-path="../../../../_"></script>
<script async src="../../../../_/js/vendor/tabs.js"></script>
<script async src="../../../../_/js/vendor/highlight.js"></script>
  </body>
</html>
